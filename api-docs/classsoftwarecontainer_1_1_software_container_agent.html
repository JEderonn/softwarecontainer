<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>softwarecontainer: softwarecontainer::SoftwareContainerAgent Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">softwarecontainer
   &#160;<span id="projectnumber">0.15.0-0d47ef7 2017-01-11</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Structure&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classsoftwarecontainer_1_1_software_container_agent.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">softwarecontainer::SoftwareContainerAgent Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A wrapper class.  
 <a href="classsoftwarecontainer_1_1_software_container_agent.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="softwarecontaineragent_8h_source.html">softwarecontaineragent.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:accd6bd43a175d6b59be24c1172b5de5f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#accd6bd43a175d6b59be24c1172b5de5f">SoftwareContainerAgent</a> (Glib::RefPtr&lt; Glib::MainContext &gt; mainLoopContext, const <a class="el" href="classsoftwarecontainer_1_1_config.html">Config</a> &amp;config)</td></tr>
<tr class="memdesc:accd6bd43a175d6b59be24c1172b5de5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">creates a new agent object and runs some initialization  <a href="#accd6bd43a175d6b59be24c1172b5de5f">More...</a><br /></td></tr>
<tr class="separator:accd6bd43a175d6b59be24c1172b5de5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87e2217b1539db92e21a816f075aa4bd"><td class="memItemLeft" align="right" valign="top">std::vector&lt; ContainerID &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#a87e2217b1539db92e21a816f075aa4bd">listContainers</a> ()</td></tr>
<tr class="memdesc:a87e2217b1539db92e21a816f075aa4bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">get a list of all containers  <a href="#a87e2217b1539db92e21a816f075aa4bd">More...</a><br /></td></tr>
<tr class="separator:a87e2217b1539db92e21a816f075aa4bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0468131b581790fd41b1dd8e077f8654"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#a0468131b581790fd41b1dd8e077f8654">listCapabilities</a> ()</td></tr>
<tr class="memdesc:a0468131b581790fd41b1dd8e077f8654"><td class="mdescLeft">&#160;</td><td class="mdescRight">List all capabilities that the user can set.  <a href="#a0468131b581790fd41b1dd8e077f8654">More...</a><br /></td></tr>
<tr class="separator:a0468131b581790fd41b1dd8e077f8654"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66b745cd67c87b48a71b368edffaef83"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#a66b745cd67c87b48a71b368edffaef83">deleteContainer</a> (ContainerID containerID)</td></tr>
<tr class="memdesc:a66b745cd67c87b48a71b368edffaef83"><td class="mdescLeft">&#160;</td><td class="mdescRight">delete container by ID  <a href="#a66b745cd67c87b48a71b368edffaef83">More...</a><br /></td></tr>
<tr class="separator:a66b745cd67c87b48a71b368edffaef83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51595505c72fe46fffb502b2db6ef814"><td class="memItemLeft" align="right" valign="top">SoftwareContainerPtr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#a51595505c72fe46fffb502b2db6ef814">getContainer</a> (ContainerID containerID)</td></tr>
<tr class="memdesc:a51595505c72fe46fffb502b2db6ef814"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetches a pointer to a <a class="el" href="classsoftwarecontainer_1_1_software_container.html">SoftwareContainer</a> matching an ID.  <a href="#a51595505c72fe46fffb502b2db6ef814">More...</a><br /></td></tr>
<tr class="separator:a51595505c72fe46fffb502b2db6ef814"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01b902dd215af783c7863d267758e91e"><td class="memItemLeft" align="right" valign="top">ReturnCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#a01b902dd215af783c7863d267758e91e">readConfigElement</a> (const json_t *element)</td></tr>
<tr class="memdesc:a01b902dd215af783c7863d267758e91e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tries to read a config in json format for a container.  <a href="#a01b902dd215af783c7863d267758e91e">More...</a><br /></td></tr>
<tr class="separator:a01b902dd215af783c7863d267758e91e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a963368abdad10b1401baec80a7abb327"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#a963368abdad10b1401baec80a7abb327">parseConfig</a> (const std::string &amp;config)</td></tr>
<tr class="memdesc:a963368abdad10b1401baec80a7abb327"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse config needed for starting up the container in a correct manner.  <a href="#a963368abdad10b1401baec80a7abb327">More...</a><br /></td></tr>
<tr class="separator:a963368abdad10b1401baec80a7abb327"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adedc44d2112a0467bdddf68c19f37667"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#adedc44d2112a0467bdddf68c19f37667">createContainer</a> (const std::string &amp;config, ContainerID &amp;containerID)</td></tr>
<tr class="memdesc:adedc44d2112a0467bdddf68c19f37667"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new container.  <a href="#adedc44d2112a0467bdddf68c19f37667">More...</a><br /></td></tr>
<tr class="separator:adedc44d2112a0467bdddf68c19f37667"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa56cfb46275b5cb0959ab9fdbbee148b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#aa56cfb46275b5cb0959ab9fdbbee148b">execute</a> (ContainerID containerID, const std::string &amp;cmdLine, const std::string &amp;workingDirectory, const std::string &amp;outputFile, const EnvironmentVariables &amp;env, int32_t &amp;pid, std::function&lt; void(pid_t, int)&gt; listener)</td></tr>
<tr class="memdesc:aa56cfb46275b5cb0959ab9fdbbee148b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Launch the given command in a the given container.  <a href="#aa56cfb46275b5cb0959ab9fdbbee148b">More...</a><br /></td></tr>
<tr class="separator:aa56cfb46275b5cb0959ab9fdbbee148b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dd0cf44da28cf8781e6c29c5d09eb86"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#a4dd0cf44da28cf8781e6c29c5d09eb86">shutdownContainer</a> (ContainerID containerID)</td></tr>
<tr class="memdesc:a4dd0cf44da28cf8781e6c29c5d09eb86"><td class="mdescLeft">&#160;</td><td class="mdescRight">shuts down a container  <a href="#a4dd0cf44da28cf8781e6c29c5d09eb86">More...</a><br /></td></tr>
<tr class="separator:a4dd0cf44da28cf8781e6c29c5d09eb86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9f97277f85c0abc20fc87eb4e285d24"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#aa9f97277f85c0abc20fc87eb4e285d24">suspendContainer</a> (ContainerID containerID)</td></tr>
<tr class="memdesc:aa9f97277f85c0abc20fc87eb4e285d24"><td class="mdescLeft">&#160;</td><td class="mdescRight">suspends execution of a container  <a href="#aa9f97277f85c0abc20fc87eb4e285d24">More...</a><br /></td></tr>
<tr class="separator:aa9f97277f85c0abc20fc87eb4e285d24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4015d7ba7850424994fe561c5dbe333"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#ac4015d7ba7850424994fe561c5dbe333">resumeContainer</a> (ContainerID containerID)</td></tr>
<tr class="memdesc:ac4015d7ba7850424994fe561c5dbe333"><td class="mdescLeft">&#160;</td><td class="mdescRight">resumes execution of a container  <a href="#ac4015d7ba7850424994fe561c5dbe333">More...</a><br /></td></tr>
<tr class="separator:ac4015d7ba7850424994fe561c5dbe333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb3ac782dd520cfaa1b61f7ddf090dce"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#abb3ac782dd520cfaa1b61f7ddf090dce">bindMount</a> (const ContainerID containerID, const std::string &amp;pathInHost, const std::string &amp;pathInContainer, bool readOnly)</td></tr>
<tr class="memdesc:abb3ac782dd520cfaa1b61f7ddf090dce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bind mount a folder into the container.  <a href="#abb3ac782dd520cfaa1b61f7ddf090dce">More...</a><br /></td></tr>
<tr class="separator:abb3ac782dd520cfaa1b61f7ddf090dce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73440dfba6dfaaab1c11190513d4d65e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#a73440dfba6dfaaab1c11190513d4d65e">setCapabilities</a> (const ContainerID &amp;containerID, const std::vector&lt; std::string &gt; &amp;capabilities)</td></tr>
<tr class="memdesc:a73440dfba6dfaaab1c11190513d4d65e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set capabilities for the container.  <a href="#a73440dfba6dfaaab1c11190513d4d65e">More...</a><br /></td></tr>
<tr class="separator:a73440dfba6dfaaab1c11190513d4d65e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6a03013678107248afc0d2788ba7942"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classsoftwarecontainer_1_1_workspace.html">Workspace</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html#ab6a03013678107248afc0d2788ba7942">getWorkspace</a> ()</td></tr>
<tr class="memdesc:ab6a03013678107248afc0d2788ba7942"><td class="mdescLeft">&#160;</td><td class="mdescRight">get a pointer to the workspace used TODO: This is only used for testing  <a href="#ab6a03013678107248afc0d2788ba7942">More...</a><br /></td></tr>
<tr class="separator:ab6a03013678107248afc0d2788ba7942"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A wrapper class. </p>

<p>Definition at line <a class="el" href="softwarecontaineragent_8h_source.html#l00050">50</a> of file <a class="el" href="softwarecontaineragent_8h_source.html">softwarecontaineragent.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="accd6bd43a175d6b59be24c1172b5de5f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">softwarecontainer::SoftwareContainerAgent::SoftwareContainerAgent </td>
          <td>(</td>
          <td class="paramtype">Glib::RefPtr&lt; Glib::MainContext &gt;&#160;</td>
          <td class="paramname"><em>mainLoopContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classsoftwarecontainer_1_1_config.html">Config</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>creates a new agent object and runs some initialization </p>
<p>This will check if the workspace is sound, and also call triggerPreload() The config is used to set various values in the agent, or for the agent to pass along to objects it creates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mainLoopContext</td><td>A Glib::MainContext </td></tr>
    <tr><td class="paramname">config</td><td>A general <a class="el" href="classsoftwarecontainer_1_1_software_container.html">SoftwareContainer</a> config</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">ReturnCode::FAILURE</td><td>if initialization of the agent fails </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00025">25</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>

<p>References <a class="el" href="config_8cpp_source.html#l00139">softwarecontainer::Config::getBooleanValue()</a>, <a class="el" href="config_8cpp_source.html#l00134">softwarecontainer::Config::getIntegerValue()</a>, and <a class="el" href="config_8cpp_source.html#l00129">softwarecontainer::Config::getStringValue()</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                             :</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    m_mainLoopContext(mainLoopContext)</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    m_containerIdPool.push_back(0);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// Get all configs for this objects members</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        m_preloadCount = config.getIntegerValue(Config::SC_GROUP,</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                                                Config::PRELOAD_COUNT_KEY);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="comment">//TODO: the inversion of the value here should be worked away,</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="comment">//      but doesn&#39;t seem to work anyway, see bug</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        m_shutdownContainers = !config.getBooleanValue(Config::SC_GROUP,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                                       Config::KEEP_CONTAINERS_ALIVE_KEY);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    } <span class="keywordflow">catch</span> (ConfigError &amp;error) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">throw</span> ReturnCode::FAILURE;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// Get all configs for the workspace</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordtype">int</span> shutdownTimeout;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    std::string containerRootDir;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    std::string lxcConfigPath;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        shutdownTimeout = config.getIntegerValue(Config::SC_GROUP, Config::SHUTDOWN_TIMEOUT_KEY);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        containerRootDir = config.getStringValue(Config::SC_GROUP, Config::SHARED_MOUNTS_DIR_KEY);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        lxcConfigPath = config.getStringValue(Config::SC_GROUP, Config::LXC_CONFIG_PATH_KEY);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    } <span class="keywordflow">catch</span> (ConfigError &amp;error) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">throw</span> ReturnCode::FAILURE;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// Create and set all values on workspace</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        m_softwarecontainerWorkspace = std::make_shared&lt;Workspace&gt;();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        m_softwarecontainerWorkspace-&gt;m_enableWriteBuffer = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        m_softwarecontainerWorkspace-&gt;m_containerRootDir = containerRootDir;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        m_softwarecontainerWorkspace-&gt;m_containerConfigPath = lxcConfigPath;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        m_softwarecontainerWorkspace-&gt;m_containerShutdownTimeout = shutdownTimeout;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    } <span class="keywordflow">catch</span> (ReturnCode err) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Failed to set up workspace&quot;</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">throw</span> ReturnCode::FAILURE;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> (!triggerPreload()) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Failed to preload&quot;</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">throw</span> ReturnCode::FAILURE;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// Get all configs for the config stores</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    std::string serviceManifestDir;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    std::string defaultServiceManifestDir;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        serviceManifestDir = config.getStringValue(Config::SC_GROUP,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                                   Config::SERVICE_MANIFEST_DIR_KEY);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        defaultServiceManifestDir = config.getStringValue(Config::SC_GROUP,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                                          Config::DEFAULT_SERVICE_MANIFEST_DIR_KEY);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    } <span class="keywordflow">catch</span> (ConfigError &amp;error) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">throw</span> ReturnCode::FAILURE;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        m_filteredConfigStore = std::make_shared&lt;FilteredConfigStore&gt;(serviceManifestDir);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        m_defaultConfigStore = std::make_shared&lt;DefaultConfigStore&gt;(defaultServiceManifestDir);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    } <span class="keywordflow">catch</span> (ReturnCode err) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Failed to initialize ConfigStore&quot;</span>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">throw</span> ReturnCode::FAILURE;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classsoftwarecontainer_1_1_software_container_agent_accd6bd43a175d6b59be24c1172b5de5f_cgraph.svg" width="398" height="183"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a87e2217b1539db92e21a816f075aa4bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; ContainerID &gt; softwarecontainer::SoftwareContainerAgent::listContainers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get a list of all containers </p>
<dl class="section return"><dt>Returns</dt><dd>a vector of container IDs </dd></dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00122">122</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    std::vector&lt;ContainerID&gt; containers;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;cont : m_containers) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        containers.push_back(cont.first);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> containers;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0468131b581790fd41b1dd8e077f8654"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; softwarecontainer::SoftwareContainerAgent::listCapabilities </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List all capabilities that the user can set. </p>
<p>Capabilities are a mapping from a string to a set of gateway configurations. This method returns all capability names that can be used through setCapabilities.</p>
<dl class="section return"><dt>Returns</dt><dd>a list of capabilities </dd></dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00432">432</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;{</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">return</span> m_filteredConfigStore-&gt;IDs();</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a66b745cd67c87b48a71b368edffaef83"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool softwarecontainer::SoftwareContainerAgent::deleteContainer </td>
          <td>(</td>
          <td class="paramtype">ContainerID&#160;</td>
          <td class="paramname"><em>containerID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>delete container by ID </p>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00132">132</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>

<p>Referenced by <a class="el" href="softwarecontaineragent_8cpp_source.html#l00343">shutdownContainer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (!isIdValid(containerID)) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Invalid container ID &quot;</span> &lt;&lt; containerID;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    m_containers.erase(containerID);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    m_containerIdPool.push_back(containerID);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classsoftwarecontainer_1_1_software_container_agent_a66b745cd67c87b48a71b368edffaef83_icgraph.svg" width="387" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a51595505c72fe46fffb502b2db6ef814"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SoftwareContainerAgent::SoftwareContainerPtr softwarecontainer::SoftwareContainerAgent::getContainer </td>
          <td>(</td>
          <td class="paramtype">ContainerID&#160;</td>
          <td class="paramname"><em>containerID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fetches a pointer to a <a class="el" href="classsoftwarecontainer_1_1_software_container.html">SoftwareContainer</a> matching an ID. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">containerID</td><td>the ID for the container </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the matched container if there is such a container. Otherwise return empty pointer. </dd></dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00144">144</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>

<p>Referenced by <a class="el" href="softwarecontaineragent_8cpp_source.html#l00393">bindMount()</a>, <a class="el" href="softwarecontaineragent_8cpp_source.html#l00283">execute()</a>, <a class="el" href="softwarecontaineragent_8cpp_source.html#l00382">resumeContainer()</a>, <a class="el" href="softwarecontaineragent_8cpp_source.html#l00343">shutdownContainer()</a>, and <a class="el" href="softwarecontaineragent_8cpp_source.html#l00371">suspendContainer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;{</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (!isIdValid(containerID)) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Invalid container ID &quot;</span> &lt;&lt; containerID;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">return</span> m_containers[containerID];</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classsoftwarecontainer_1_1_software_container_agent_a51595505c72fe46fffb502b2db6ef814_icgraph.svg" width="387" height="387"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a01b902dd215af783c7863d267758e91e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ReturnCode softwarecontainer::SoftwareContainerAgent::readConfigElement </td>
          <td>(</td>
          <td class="paramtype">const json_t *&#160;</td>
          <td class="paramname"><em>element</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tries to read a config in json format for a container. </p>
<p>One can pass options to the agent when creating containers, options that are not gateway specific. These options will be read by this function</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">element</td><td>a config snippet in json format </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ReturnCode::SUCCESS </dd></dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00154">154</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>

<p>References <a class="el" href="jsonparser_8cpp_source.html#l00051">softwarecontainer::JSONParser::read()</a>.</p>

<p>Referenced by <a class="el" href="softwarecontaineragent_8cpp_source.html#l00165">parseConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">bool</span> wo = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="classsoftwarecontainer_1_1_j_s_o_n_parser.html#a7ea50df505b43684c4a1d82ca6cb6e82">JSONParser::read</a>(element, <span class="stringliteral">&quot;enableWriteBuffer&quot;</span>, wo)) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        log_debug() &lt;&lt; <span class="stringliteral">&quot;enableWriteBuffer not found&quot;</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    m_softwarecontainerWorkspace-&gt;m_enableWriteBuffer = wo;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">return</span> ReturnCode::SUCCESS;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="ttc" id="classsoftwarecontainer_1_1_j_s_o_n_parser_html_a7ea50df505b43684c4a1d82ca6cb6e82"><div class="ttname"><a href="classsoftwarecontainer_1_1_j_s_o_n_parser.html#a7ea50df505b43684c4a1d82ca6cb6e82">softwarecontainer::JSONParser::read</a></div><div class="ttdeci">static bool read(const json_t *element, const char *key, std::string &amp;result)</div><div class="ttdoc">Reads a string from a JSON Object. </div><div class="ttdef"><b>Definition:</b> <a href="jsonparser_8cpp_source.html#l00051">jsonparser.cpp:51</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classsoftwarecontainer_1_1_software_container_agent_a01b902dd215af783c7863d267758e91e_cgraph.svg" width="356" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classsoftwarecontainer_1_1_software_container_agent_a01b902dd215af783c7863d267758e91e_icgraph.svg" width="599" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a963368abdad10b1401baec80a7abb327"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool softwarecontainer::SoftwareContainerAgent::parseConfig </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse config needed for starting up the container in a correct manner. </p>
<p>This reads a config string into json format, makes sure it is formatted correctly, and then calls readConfigElement for its elements.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">config</td><td>a configuration string </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00165">165</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>

<p>References <a class="el" href="softwarecontaineragent_8cpp_source.html#l00154">readConfigElement()</a>.</p>

<p>Referenced by <a class="el" href="softwarecontaineragent_8cpp_source.html#l00224">createContainer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;{</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">if</span> (config.size() == 0) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        log_warning() &lt;&lt; <span class="stringliteral">&quot;No configuration interpreted&quot;</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    json_error_t error;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    json_t *root = json_loads(config.c_str(), 0, &amp;error);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (!root) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Could not parse config: &quot;</span> &lt;&lt; error.text;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        log_error() &lt;&lt; config;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (!json_is_array(root)) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Root JSON element is not an array&quot;</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">size_t</span> index;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    json_t *element;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    json_array_foreach(root, index, element) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">if</span> (!json_is_object(element)) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            log_error() &lt;&lt; <span class="stringliteral">&quot;json configuration is not an object&quot;</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span> (isError(<a class="code" href="classsoftwarecontainer_1_1_software_container_agent.html#a01b902dd215af783c7863d267758e91e">readConfigElement</a>(element))) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            log_error() &lt;&lt; <span class="stringliteral">&quot;Could not read config element&quot;</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    json_decref(root);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;}</div>
<div class="ttc" id="classsoftwarecontainer_1_1_software_container_agent_html_a01b902dd215af783c7863d267758e91e"><div class="ttname"><a href="classsoftwarecontainer_1_1_software_container_agent.html#a01b902dd215af783c7863d267758e91e">softwarecontainer::SoftwareContainerAgent::readConfigElement</a></div><div class="ttdeci">ReturnCode readConfigElement(const json_t *element)</div><div class="ttdoc">Tries to read a config in json format for a container. </div><div class="ttdef"><b>Definition:</b> <a href="softwarecontaineragent_8cpp_source.html#l00154">softwarecontaineragent.cpp:154</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classsoftwarecontainer_1_1_software_container_agent_a963368abdad10b1401baec80a7abb327_cgraph.svg" width="568" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classsoftwarecontainer_1_1_software_container_agent_a963368abdad10b1401baec80a7abb327_icgraph.svg" width="387" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="adedc44d2112a0467bdddf68c19f37667"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool softwarecontainer::SoftwareContainerAgent::createContainer </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ContainerID &amp;&#160;</td>
          <td class="paramname"><em>containerID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new container. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">config</td><td>container-wide configuration string </td></tr>
    <tr><td class="paramname">a</td><td>reference to ContainerID</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If the container is successfully created true otherwise false </dd></dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00224">224</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>

<p>References <a class="el" href="softwarecontaineragent_8cpp_source.html#l00165">parseConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;{</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    profilepoint(<span class="stringliteral">&quot;createContainerStart&quot;</span>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    profilefunction(<span class="stringliteral">&quot;createContainerFunction&quot;</span>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classsoftwarecontainer_1_1_software_container_agent.html#a963368abdad10b1401baec80a7abb327">parseConfig</a>(config)) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;The provided config could not be successfully parsed&quot;</span>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        containerID = INVALID_CONTAINER_ID;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    std::pair&lt;ContainerID, SoftwareContainerPtr&gt; pair = std::move(getContainerPair());</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    pair.second-&gt;setMainLoopContext(m_mainLoopContext);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span> (isError(pair.second-&gt;init())) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Could not init the container&quot;</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        containerID = INVALID_CONTAINER_ID;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// TODO: Would be nice if this could be done async.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">if</span> (!triggerPreload()) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        log_warning() &lt;&lt; <span class="stringliteral">&quot;Failed to preload new container&quot;</span>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    m_containers.insert(std::move(pair));</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    containerID = pair.first;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div>
<div class="ttc" id="classsoftwarecontainer_1_1_software_container_agent_html_a963368abdad10b1401baec80a7abb327"><div class="ttname"><a href="classsoftwarecontainer_1_1_software_container_agent.html#a963368abdad10b1401baec80a7abb327">softwarecontainer::SoftwareContainerAgent::parseConfig</a></div><div class="ttdeci">bool parseConfig(const std::string &amp;config)</div><div class="ttdoc">Parse config needed for starting up the container in a correct manner. </div><div class="ttdef"><b>Definition:</b> <a href="softwarecontaineragent_8cpp_source.html#l00165">softwarecontaineragent.cpp:165</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classsoftwarecontainer_1_1_software_container_agent_adedc44d2112a0467bdddf68c19f37667_cgraph.svg" width="780" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa56cfb46275b5cb0959ab9fdbbee148b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool softwarecontainer::SoftwareContainerAgent::execute </td>
          <td>(</td>
          <td class="paramtype">ContainerID&#160;</td>
          <td class="paramname"><em>containerID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>cmdLine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>workingDirectory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>outputFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const EnvironmentVariables &amp;&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t &amp;&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; void(pid_t, int)&gt;&#160;</td>
          <td class="paramname"><em>listener</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Launch the given command in a the given container. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">containerID</td><td>the id for the container </td></tr>
    <tr><td class="paramname">cmdLine</td><td>the command to run </td></tr>
    <tr><td class="paramname">workingDirectory</td><td>the working directory to use when running </td></tr>
    <tr><td class="paramname">outputFile</td><td>where to log any output </td></tr>
    <tr><td class="paramname">env</td><td>any environment variables to pass to the command </td></tr>
    <tr><td class="paramname">pid</td><td>process id which belongs to given command </td></tr>
    <tr><td class="paramname">listener</td><td>a function that runs when the process exits </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true or false indicating whether or not the operation was successful. </dd></dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00283">283</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>

<p>References <a class="el" href="softwarecontaineragent_8cpp_source.html#l00144">getContainer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;{</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    profilefunction(<span class="stringliteral">&quot;executeFunction&quot;</span>);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    SoftwareContainerPtr container = <a class="code" href="classsoftwarecontainer_1_1_software_container_agent.html#a51595505c72fe46fffb502b2db6ef814">getContainer</a>(containerID);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> (!container) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Invalid container ID &quot;</span> &lt;&lt; containerID;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        pid = INVALID_PID;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">     * We want to always apply any default capabilities we have. If the container is in READY state,</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">     * that means that its gateways have been configured. The only way to configure the gateways</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">     * from the agent is through setCapabilities - which sets the default caps also.</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">     * If it has not been set, then we use a call without arguments to setCapabilities to set it up,</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">     * since we then should get only the default ones.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (container-&gt;getContainerState() != ContainerState::READY) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        log_info() &lt;&lt; <span class="stringliteral">&quot;Container not configured yet, configuring with default capabilities, if any&quot;</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        GatewayConfiguration gatewayConfigs = m_defaultConfigStore-&gt;configs();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">if</span> (!updateGatewayConfigs(containerID, gatewayConfigs)) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            log_error() &lt;&lt; <span class="stringliteral">&quot;Could not set default capabilities on container &quot;</span> &lt;&lt; containerID;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            pid = INVALID_PID;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">// Set up a CommandJob for this run in the container</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keyword">auto</span> job = <span class="keyword">new</span> CommandJob(*container, cmdLine);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    job-&gt;setOutputFile(outputFile);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    job-&gt;setEnvironmentVariables(env);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    job-&gt;setWorkingDirectory(workingDirectory);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// Start it</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (isError(job-&gt;start())) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Could not start job&quot;</span>;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        pid = INVALID_PID;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// If things went well, do what we need when it exits</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    addProcessListener(m_connections, job-&gt;pid(), [listener](pid_t pid, <span class="keywordtype">int</span> exitCode) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        listener(pid, exitCode);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }, m_mainLoopContext);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// Save the job</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    m_jobs.push_back(job);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    profilepoint(<span class="stringliteral">&quot;executeEnd&quot;</span>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    pid = job-&gt;pid();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
<div class="ttc" id="classsoftwarecontainer_1_1_software_container_agent_html_a51595505c72fe46fffb502b2db6ef814"><div class="ttname"><a href="classsoftwarecontainer_1_1_software_container_agent.html#a51595505c72fe46fffb502b2db6ef814">softwarecontainer::SoftwareContainerAgent::getContainer</a></div><div class="ttdeci">SoftwareContainerPtr getContainer(ContainerID containerID)</div><div class="ttdoc">Fetches a pointer to a SoftwareContainer matching an ID. </div><div class="ttdef"><b>Definition:</b> <a href="softwarecontaineragent_8cpp_source.html#l00144">softwarecontaineragent.cpp:144</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classsoftwarecontainer_1_1_software_container_agent_aa56cfb46275b5cb0959ab9fdbbee148b_cgraph.svg" width="387" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4dd0cf44da28cf8781e6c29c5d09eb86"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool softwarecontainer::SoftwareContainerAgent::shutdownContainer </td>
          <td>(</td>
          <td class="paramtype">ContainerID&#160;</td>
          <td class="paramname"><em>containerID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>shuts down a container </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">containerID</td><td>the container to shut down </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00343">343</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>

<p>References <a class="el" href="softwarecontaineragent_8cpp_source.html#l00132">deleteContainer()</a>, and <a class="el" href="softwarecontaineragent_8cpp_source.html#l00144">getContainer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;{</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    profilefunction(<span class="stringliteral">&quot;shutdownContainerFunction&quot;</span>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span> (!m_shutdownContainers) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        log_info() &lt;&lt; <span class="stringliteral">&quot;Not shutting down containers, so not shutting down &quot;</span> &lt;&lt; containerID;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    SoftwareContainerPtr container = <a class="code" href="classsoftwarecontainer_1_1_software_container_agent.html#a51595505c72fe46fffb502b2db6ef814">getContainer</a>(containerID);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> (!container) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Invalid container ID &quot;</span> &lt;&lt; containerID;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordtype">int</span> timeout = m_softwarecontainerWorkspace-&gt;m_containerShutdownTimeout;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> (isError(container-&gt;shutdown(timeout))) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Could not shut down the container&quot;</span>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classsoftwarecontainer_1_1_software_container_agent.html#a66b745cd67c87b48a71b368edffaef83">deleteContainer</a>(containerID)) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Could not delete the container&quot;</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;}</div>
<div class="ttc" id="classsoftwarecontainer_1_1_software_container_agent_html_a51595505c72fe46fffb502b2db6ef814"><div class="ttname"><a href="classsoftwarecontainer_1_1_software_container_agent.html#a51595505c72fe46fffb502b2db6ef814">softwarecontainer::SoftwareContainerAgent::getContainer</a></div><div class="ttdeci">SoftwareContainerPtr getContainer(ContainerID containerID)</div><div class="ttdoc">Fetches a pointer to a SoftwareContainer matching an ID. </div><div class="ttdef"><b>Definition:</b> <a href="softwarecontaineragent_8cpp_source.html#l00144">softwarecontaineragent.cpp:144</a></div></div>
<div class="ttc" id="classsoftwarecontainer_1_1_software_container_agent_html_a66b745cd67c87b48a71b368edffaef83"><div class="ttname"><a href="classsoftwarecontainer_1_1_software_container_agent.html#a66b745cd67c87b48a71b368edffaef83">softwarecontainer::SoftwareContainerAgent::deleteContainer</a></div><div class="ttdeci">bool deleteContainer(ContainerID containerID)</div><div class="ttdoc">delete container by ID </div><div class="ttdef"><b>Definition:</b> <a href="softwarecontaineragent_8cpp_source.html#l00132">softwarecontaineragent.cpp:132</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classsoftwarecontainer_1_1_software_container_agent_a4dd0cf44da28cf8781e6c29c5d09eb86_cgraph.svg" width="387" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa9f97277f85c0abc20fc87eb4e285d24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool softwarecontainer::SoftwareContainerAgent::suspendContainer </td>
          <td>(</td>
          <td class="paramtype">ContainerID&#160;</td>
          <td class="paramname"><em>containerID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>suspends execution of a container </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">containerID</td><td>the container to suspend </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00371">371</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>

<p>References <a class="el" href="softwarecontaineragent_8cpp_source.html#l00144">getContainer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;{</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    SoftwareContainerPtr container = <a class="code" href="classsoftwarecontainer_1_1_software_container_agent.html#a51595505c72fe46fffb502b2db6ef814">getContainer</a>(containerID);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span> (!container) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Can&#39;t suspend container &quot;</span> &lt;&lt; containerID;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">return</span> isSuccess(container-&gt;suspend());</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}</div>
<div class="ttc" id="classsoftwarecontainer_1_1_software_container_agent_html_a51595505c72fe46fffb502b2db6ef814"><div class="ttname"><a href="classsoftwarecontainer_1_1_software_container_agent.html#a51595505c72fe46fffb502b2db6ef814">softwarecontainer::SoftwareContainerAgent::getContainer</a></div><div class="ttdeci">SoftwareContainerPtr getContainer(ContainerID containerID)</div><div class="ttdoc">Fetches a pointer to a SoftwareContainer matching an ID. </div><div class="ttdef"><b>Definition:</b> <a href="softwarecontaineragent_8cpp_source.html#l00144">softwarecontaineragent.cpp:144</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classsoftwarecontainer_1_1_software_container_agent_aa9f97277f85c0abc20fc87eb4e285d24_cgraph.svg" width="387" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac4015d7ba7850424994fe561c5dbe333"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool softwarecontainer::SoftwareContainerAgent::resumeContainer </td>
          <td>(</td>
          <td class="paramtype">ContainerID&#160;</td>
          <td class="paramname"><em>containerID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>resumes execution of a container </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">containerID</td><td>the container to resume </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00382">382</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>

<p>References <a class="el" href="softwarecontaineragent_8cpp_source.html#l00144">getContainer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;{</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    SoftwareContainerPtr container = <a class="code" href="classsoftwarecontainer_1_1_software_container_agent.html#a51595505c72fe46fffb502b2db6ef814">getContainer</a>(containerID);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">if</span> (!container) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Can&#39;t resume container &quot;</span> &lt;&lt; containerID;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">return</span> isSuccess(container-&gt;resume());</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;}</div>
<div class="ttc" id="classsoftwarecontainer_1_1_software_container_agent_html_a51595505c72fe46fffb502b2db6ef814"><div class="ttname"><a href="classsoftwarecontainer_1_1_software_container_agent.html#a51595505c72fe46fffb502b2db6ef814">softwarecontainer::SoftwareContainerAgent::getContainer</a></div><div class="ttdeci">SoftwareContainerPtr getContainer(ContainerID containerID)</div><div class="ttdoc">Fetches a pointer to a SoftwareContainer matching an ID. </div><div class="ttdef"><b>Definition:</b> <a href="softwarecontaineragent_8cpp_source.html#l00144">softwarecontaineragent.cpp:144</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classsoftwarecontainer_1_1_software_container_agent_ac4015d7ba7850424994fe561c5dbe333_cgraph.svg" width="387" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="abb3ac782dd520cfaa1b61f7ddf090dce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool softwarecontainer::SoftwareContainerAgent::bindMount </td>
          <td>(</td>
          <td class="paramtype">const ContainerID&#160;</td>
          <td class="paramname"><em>containerID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pathInHost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pathInContainer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>readOnly</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Bind mount a folder into the container. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">containerID</td><td>the container to bind into </td></tr>
    <tr><td class="paramname">pathInHost</td><td>path to the folder in the host system </td></tr>
    <tr><td class="paramname">subPathInContainer</td><td>path (relative to a fixed start point) to use in the container </td></tr>
    <tr><td class="paramname">readOnly</td><td>whether or not to mount read-only </td></tr>
    <tr><td class="paramname">reference</td><td>to the full path of the mounted folder in the container</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true or false indicating whether or not the operation was successful. </dd></dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00393">393</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>

<p>References <a class="el" href="softwarecontaineragent_8cpp_source.html#l00144">getContainer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;{</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    profilefunction(<span class="stringliteral">&quot;bindMountFunction&quot;</span>);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    SoftwareContainerPtr container = <a class="code" href="classsoftwarecontainer_1_1_software_container_agent.html#a51595505c72fe46fffb502b2db6ef814">getContainer</a>(containerID);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> (!container) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Invalid container ID &quot;</span> &lt;&lt; containerID;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    ReturnCode result = container-&gt;getContainer()-&gt;bindMountInContainer(pathInHost,</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                                                                        pathInContainer,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                                                        readOnly);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (isError(result)) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Unable to bind mount &quot;</span> &lt;&lt; pathInHost &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; pathInContainer;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div>
<div class="ttc" id="classsoftwarecontainer_1_1_software_container_agent_html_a51595505c72fe46fffb502b2db6ef814"><div class="ttname"><a href="classsoftwarecontainer_1_1_software_container_agent.html#a51595505c72fe46fffb502b2db6ef814">softwarecontainer::SoftwareContainerAgent::getContainer</a></div><div class="ttdeci">SoftwareContainerPtr getContainer(ContainerID containerID)</div><div class="ttdoc">Fetches a pointer to a SoftwareContainer matching an ID. </div><div class="ttdef"><b>Definition:</b> <a href="softwarecontaineragent_8cpp_source.html#l00144">softwarecontaineragent.cpp:144</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classsoftwarecontainer_1_1_software_container_agent_abb3ac782dd520cfaa1b61f7ddf090dce_cgraph.svg" width="387" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a73440dfba6dfaaab1c11190513d4d65e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool softwarecontainer::SoftwareContainerAgent::setCapabilities </td>
          <td>(</td>
          <td class="paramtype">const ContainerID &amp;&#160;</td>
          <td class="paramname"><em>containerID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>capabilities</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set capabilities for the container. </p>
<p>Capabilities are a mapping from a string to a set of gateway configurations. Capabilities are translated into gateway configurations and then sent the same way as with startGateways</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">containerID</td><td>the container to use </td></tr>
    <tr><td class="paramname">capabilities</td><td>the capabilities</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success, false otherwise </dd></dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00437">437</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;{</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">if</span> (capabilities.empty()) {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        log_warning() &lt;&lt; <span class="stringliteral">&quot;Got empty list of capabilities&quot;</span>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    GatewayConfiguration gatewayConfigs = m_defaultConfigStore-&gt;configs();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    GatewayConfiguration filteredConfigs = m_filteredConfigStore-&gt;configsByID(capabilities);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">// If we get an empty config the user passed a non existent cap name</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">if</span> (filteredConfigs.empty()) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        log_debug() &lt;&lt; <span class="stringliteral">&quot;One or more capabilities were not found&quot;</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    gatewayConfigs.append(filteredConfigs);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// Update container gateway configuration</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">if</span> (!updateGatewayConfigs(containerID, gatewayConfigs)) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        log_error() &lt;&lt; <span class="stringliteral">&quot;Could not set gateway configuration for capability&quot;</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab6a03013678107248afc0d2788ba7942"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="classsoftwarecontainer_1_1_workspace.html">Workspace</a> &gt; softwarecontainer::SoftwareContainerAgent::getWorkspace </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get a pointer to the workspace used TODO: This is only used for testing </p>
<dl class="section return"><dt>Returns</dt><dd>a shared pointer to the current workspace </dd></dl>

<p>Definition at line <a class="el" href="softwarecontaineragent_8cpp_source.html#l00466">466</a> of file <a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;{</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">return</span> m_softwarecontainerWorkspace;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>agent/src/<a class="el" href="softwarecontaineragent_8h_source.html">softwarecontaineragent.h</a></li>
<li>agent/src/<a class="el" href="softwarecontaineragent_8cpp_source.html">softwarecontaineragent.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>softwarecontainer</b></li><li class="navelem"><a class="el" href="classsoftwarecontainer_1_1_software_container_agent.html">SoftwareContainerAgent</a></li>
    <li class="footer">Generated on Wed Jan 11 2017 17:00:00 for softwarecontainer by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
