<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Integration guidelines &#8212; softwarecontainer 0.9.1-8639fe0 2016-11-21 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.9.1-8639fe0 2016-11-21',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="top" title="softwarecontainer 0.9.1-8639fe0 2016-11-21 documentation" href="../../index.html" />
    <link rel="next" title="Troubleshooting" href="../troubleshooting/index.html" />
    <link rel="prev" title="Gateways" href="../gateways/index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="integration-guidelines">
<span id="id1"></span><h1>Integration guidelines<a class="headerlink" href="#integration-guidelines" title="Permalink to this headline">¶</a></h1>
<p>This chapter describes the workflow, major tasks and concepts involved in integrating SoftwareContainer
into a platform. A brief summary of the general steps involved:</p>
<ol class="arabic simple">
<li>Setting up the various IPC mechanisms, that should be reachable from inside containers, on the host system.</li>
<li>Writing service manifests for capabilities of the platform.</li>
<li>Integrating a launcher that interact with the SoftwareContainerAgent.</li>
</ol>
<p>Below follows information about what SoftwareContainer assumes about the host system when handling different
IPC mechanisms and examples of configuration and usage.</p>
<div class="section" id="service-manifests">
<h2>Service manifests<a class="headerlink" href="#service-manifests" title="Permalink to this headline">¶</a></h2>
<p>For details about format and content of service manifests, see <a class="reference internal" href="../service-manifests/index.html#service-manifests"><span class="std std-ref">Service manifests</span></a>
and <a class="reference internal" href="../gateways/index.html#gateways"><span class="std std-ref">Gateways</span></a>.</p>
<p>Service manifests should be installed in <code class="docutils literal"><span class="pre">/etc/softwarecontainer/caps.d/&lt;service-name&gt;</span></code>.</p>
</div>
<div class="section" id="network-setup">
<h2>Network setup<a class="headerlink" href="#network-setup" title="Permalink to this headline">¶</a></h2>
<p>The network setup of software container is dependent on a network bridge being available on the
host system, if compiled with support for the network gateway. By default, SoftwareContainer will
create such a bridge on the system if it is not already there. This can be changed, so that
SoftwareContainer will simply fail with an error message if the bridge was not available.</p>
<p>The selection of whether or not to create the bridge is a compile-time option given to CMake.
Please see the README for more information about how to set the various CMake options.</p>
<p>For each container a virtual ethernet device will be set up and be bridged to the above mentioned
network bridge on the host system. The virtual ethernet device is then mapped to an ethernet device
inside of the container (usually eth0).</p>
<p>In order to configure what traffic is allowed the NetworkGateway is used. The NetworkGateway converts
the configuration it receives into iptables rules which are set for the network device inside of the
container. See <a class="reference internal" href="../gateways/index.html#gateways"><span class="std std-ref">Gateways</span></a> for more information.</p>
</div>
<div class="section" id="wayland-setup">
<h2>Wayland setup<a class="headerlink" href="#wayland-setup" title="Permalink to this headline">¶</a></h2>
<p>In order to have applications access Wayland, one needs to enable the Wayland gateway, and possibly
give access to graphics hardware. Not all applications require direct access to the graphics
hardware, see <a class="reference internal" href="../examples/index.html#wayland-example"><span class="std std-ref">Wayland example</span></a>. A reasonable capability for a Wayland
application would therefore include both the Wayland gateway and a configuration of the Device Node
gateway for any graphics hardware access needed.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>Here is an example manifest defining Wayland access:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="p">{</span>
  <span class="s">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;com.example.wayland-access&quot;</span><span class="p">,</span>
      <span class="s">&quot;gateways&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;wayland&quot;</span><span class="p">,</span>
          <span class="s">&quot;config&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">true</span>
            <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;devicenode&quot;</span><span class="p">,</span>
          <span class="s">&quot;config&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;/dev/dri/card0&quot;</span>
            <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-role-of-a-launcher">
<h2>The role of a launcher<a class="headerlink" href="#the-role-of-a-launcher" title="Permalink to this headline">¶</a></h2>
<p>This section describes what typical integration actions are needed to integrate SoftwareContainer with
a launcher. For an overview of the general architecture involving a launcher and SoftwareContainer, see
<a class="reference internal" href="../design/index.html#design"><span class="std std-ref">Design</span></a>.</p>
<p>The assumed scenario in this section is that a launcher want to start an application inside the container.</p>
<p>The launcher should do the following:</p>
<blockquote>
<div><ul class="simple">
<li>Make the app home directory available inside the container.</li>
<li>Set the HOME environment variable in the container point to the above directory.</li>
</ul>
</div></blockquote>
<p>The above actions are performed by interacting with the SoftwareContainerAgent <a class="reference internal" href="../api/index.html#api"><span class="std std-ref">D-Bus API</span></a>.</p>
<div class="section" id="setting-up-a-home-directory-and-home">
<h3>Setting up a home directory and HOME<a class="headerlink" href="#setting-up-a-home-directory-and-home" title="Permalink to this headline">¶</a></h3>
<p>By calling BindMountFolderInContainer and passing a path on the host that will be mounted inside
the container at the location specified as the <code class="docutils literal"><span class="pre">subPathInContainer</span></code> argument, a directory is
made available to an application started later. The path as it looks inside the container is returned
by the method.</p>
<p>The path inside the container is intended to be set as the <code class="docutils literal"><span class="pre">HOME</span></code> environment variable inside the
container. The variable is set when calling LaunchCommand with the appropriate <code class="docutils literal"><span class="pre">env</span></code> dictionary.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Integration guidelines</a><ul>
<li><a class="reference internal" href="#service-manifests">Service manifests</a></li>
<li><a class="reference internal" href="#network-setup">Network setup</a></li>
<li><a class="reference internal" href="#wayland-setup">Wayland setup</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-role-of-a-launcher">The role of a launcher</a><ul>
<li><a class="reference internal" href="#setting-up-a-home-directory-and-home">Setting up a home directory and HOME</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../gateways/index.html" title="previous chapter">Gateways</a></li>
      <li>Next: <a href="../troubleshooting/index.html" title="next chapter">Troubleshooting</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/chapters/integration-guidelines/index.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Pelagicore AB.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.8</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="../../_sources/chapters/integration-guidelines/index.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>